{% extends 'base.html' %}

{% macro shape(annot) %}
<table id = annotInfoTable >
    <thead>
        <tr>
            <th>Source</th>
            <th>Value</th>
            <th>Confidence</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{annot['source']}}</td>
            <td>{{annot['shape']}}</td>
            <td>{{annot['confidence']}}</td>
        </tr>
    </tbody>
</table>
{% endmacro %}

{% macro size(annot) %}
<table id = annotInfoTable >
    <thead>
        <tr>
            <th>Source</th>
            <th>Value</th>
            <th>Degree</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{annot['source']}}</td>
            <td>{{annot['size']}}</td>
            <td>{{annot['confidence']}}</td>
        </tr>
    </tbody>
</table>
{% endmacro %}

{% macro location(annot) %}
<table id = annotInfoTable >
    <thead>
        <tr>
            <th></th>
            <th>Source</th>
            <th>Relation</th>
            <th>Location</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Semantic Location:</td>    
            <td>{{annot['source']}}</td>
            <td>{{annot['reference_desc']}}</td>
            <td>{{annot['frame_id']}}</td>
        </tr>
    </tbody>
</table>
{% endmacro %}

{% macro detection(annot) %}
<table id = annotInfoTable >
    <thead>
        <tr>
            <th></th>
            <th>Source</th>
            <th>Label</th>
            <th>Confidence</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Detection Results:</td>
            <td>{{annot['source']}}</td>
            <td>{{annot['name']}}</td>
            <td>{{annot['confidence']}}</td>
        </tr>
    </tbody>
</table>
{% endmacro %}
        
{% macro color(annot) %}  
<table id = annotInfoTable >
    <thead>
        <tr>
        {% for label in annot['color']  %}
            <th>{{label}}</th>
        {% endfor %}        
        </tr>
    </thead>
    <tbody>
        <tr>
            {% for r in annot['ratio']  %}
            <td>{{'%0.3f'| format(r|float)}}</td>
            {% endfor %}
        </tr>
    
    </tbody>
</table>
{% endmacro %}

{% macro pose(annot) %}  
<p>Source: {{annot['source']}}</p>
<table id = annotInfoTable >
<thead>
    <tr>
        <th>Frame</th>
        <th>Translation</th>
        <th>Rotation</th>
    </tr>
</thead>
<tbody>
    <tr><td>Camera</td><td>{{annot['camera']['translation']}}</td><td>{{annot['camera']['rotation']}}</td></tr>
   <tr><td>World</td><td>{{annot['world']['translation']}}</td><td>{{annot['world']['rotation']}}</td></tr>
</tbody>
</table>
{% endmacro %}

{% macro geometry(annot) %}  
<table id = annotInfoTable >
<thead>
   <tr>
       <th></th>
       <th>Height [m]</th>
       <th>Width [m]</th>
       <th>Depth [m]</th>
       <th>Volume [m3]</th>
   </tr>
</thead>
<tbody>
    <tr>
        <td>3DBounding Box</td>
        <td>{{annot['boundingBox']['height']}}</td>
        <td>{{annot['boundingBox']['width']}}</td>
        <td>{{annot['boundingBox']['depth']}}</td>
        <td>{{annot['boundingBox']['volume']}}</td>
    </tr>
</tbody>
</table>
{% endmacro %}


{% macro showObject(obj) %}
<td><img src="{{ obj['image']}}"/></td>
      <td>    
            <div id = content>   
            {%for a in obj['annotations']%}
                <div class="page_collapsible" id="body-section1">{{a['_type']}}<span></span></div>
                <div class="container">
                <div class= "content">
                    {% if  a['_type']|string() =='rs.annotation.Shape' %}
                        {{ shape(a) }}
                    {% elif a['_type']|string() =='rs.annotation.SemanticColor' %}
                        {{ color(a) }}
                    {% elif a['_type']|string() =='rs.annotation.PoseAnnotation' %}
                        {{ pose(a) }}
                    {% elif a['_type']|string() =='rs.annotation.Detection' %}
                        {{ detection(a) }}
                    {% elif a['_type']|string() =='rs.annotation.TFLocation' %}
                        {{ location(a) }}
                    {% elif a['_type']|string() =='rs.annotation.Geometry' %}
                        {{ geometry(a) }}
                    {% elif a['_type']|string() =='rs.annotation.SemanticSize' %}
                        {{ size(a) }}
                    {% endif %}
                </div>            
                </div>
            {%endfor%}
            </div>
      </td>
{% endmacro %}

{% block body %}
<div class="ui-layout-center">
{% if objects %}
 {#{{ pagination.info }}#}
 {#{{ pagination.links }}#}
  <div class="table-responsive">
    <table class="table table-hover">
    <thead>
      <tr>
        <th>#</th>
        <th>Image</th>
        <th>Annotations</th>
      </tr>
    </thead>
    <tbody>
      {% for obj in objects %}
      <tr>
      <td>{{ loop.index }}</td>
          {{showObject(obj)}}
        </tr>
      {% endfor %}
    </tbody>
    </table>
  </div>
  {#{{ pagination.links }}#}
{% endif %}
 
</div>
{% endblock %}

